<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="apple-mobile-web-app-capable" content="yes">

<style>
@import url(CSS/stack.css);
@import url(CSS/d3-tip.css);
@import url(CSS/figures.css);
@import url(CSS/kbroman_talk.css);
@import url(CSS/corr_w_scatter.css);
@import url(CSS/panelutil.css);
</style>

<script charset="utf-8" type="text/javascript" src="JS/d3.min.js"></script>
<script type="text/javascript" src="JS/d3.tip.js"></script>
<script type="text/javascript" src="JS/slide_transition.js"></script>


<title>Interactive graphics</title>
</head>
<body class="overview">



<section class="titlepage">
<h3 style="margin-top:-10px;" class="highlight">Interactive graphics</h3>

<h4><a href="http://kbroman.org">Karl Broman</a></h4>
<p class="nopadding">Biostatistics &amp; Medical Informatics, University of Wisconsin
&ndash; Madison</p>

<p class="nopadding"><code>
<a href="http://kbroman.org" class="gray">kbroman.org</a><br>
<a href="https://github.com/kbroman" class="gray">github.com/kbroman</a><br>
<a href="https://twitter.com/kwbroman" class="gray">@kwbroman</a>
</code></p>

<p class="nopadding"><span class="gray">slides:</span> <code><a href="http://www.biostat.wisc.edu/~kbroman/presentations/Showcase2015">bit.ly/Broman2015-04</a></code></p>

<img style="position:fixed;bottom: 30px; right:40px; z-index: -1;" width="150px" src="Figs/cc-zero.png" />



<aside>
These are slides for a seminar I will give at the Showcase 2015 by the
UW-Madison Office of Quality Improvement, 14 Apr 2015.<br><br>

Click on the link at the top-right to remove these
notes.<br><br>

These slides were tested for Chrome on a Mac and might look terrible
in some browsers.
</aside>

</section>


<section>
<h3>&nbsp;</h3>
<div id="density_estimate" class="chart"></div>

<div style="font-size:28px;width:420px;align:center;margin-left:350px;margin-top:15px">
  <div style="float:left;" id="bandwidth">Bandwidth = 1.00</div>
  <div id="bgrect" style="float:right;width:135px;">
     <input type="range" min="-2" max="1" step = "0.05" value="0"></div>
</div>
<script src="JS/density.js"></script>
<script src="JS/plotframe.js"></script>

<p class="codelink">
<a href="Coffee/density.coffee" class="gray">code</a> |
<a href="Coffee/plotframe.coffee" class="gray">plotframe</a></p>

<aside>
In graduate school (at UC Berkeley), I took a course on statistical
computing from <a href="http://www.stat.berkeley.edu/~spector/">Phil
Spector</a>.  One of the projects was to use <a
href="http://homepage.cs.uiowa.edu/~luke/xls/xlispstat/">XLisp-Stat</a>
to create an interactive plot of a density estimate, with a slider for
bandwidth.<br><br>

Why didn&rsquo;t I do anything like this in the
subsequent 15 years?  Rather than make a bunch of static plots to find
a good bandwidth, you can play around with the one interactive
plot.<br><br>

Of course, this isn&rsquo;t XLisp-Stat, but you get the idea of what we were
doing.
</aside>

<p class="pg">3</p></section>





<section>

<h3>&nbsp;</h3>

<div id="corr_w_scatter" style="margin-left:-50px;"></div>

<script type="text/javascript" src="JS/corr_w_scatter.js"></script>

<aside>
Heatmaps of things like correlation matrices can be quite useful, but
they are often hard to read.  It&rsquo;s nice to be able to read off the
values by hovering.<br><br>

Even better: to be able to click on a pixel and view the corresponding
scatterplot.<br><br>

This is a set of genes whose expression values are associated with
genotype at a common locus. In the scatterplots, the points are colored
by genotype at that locus.
</aside>

<p class="codelink">
<a href="Coffee/corr_w_scatter.coffee" class="gray">code</a> |
<a href="Data/corr_w_scatter.json" class="gray">data</a></p>
<p class="pg">8</p></section>














<section>
<h3>&nbsp;</h3>

<div id="lod_and_effect" class="fig"></div>

<aside>
We know we should not rely solely on summary statistics (like the LOD
score), but if it takes an extra step to plot the underlying details,
we tend not to do it, or at least not so much as we should.<br><br>

I&rsquo;ve come to the conclusion that <em>every</em> graph could be
improved with interactivity. You at least want tooltips.<br><br>

The curves at the top are the same LOD curves we saw before. The LOD
score is a measure of association between genotype and phenotype.<br><br>

Click on a chromosome in the top panel to see a detailed view in the
lower-left panel.  Click on a marker in the lower-left panel to see
effect estimates and raw data on the right.  Hover over things on the
right to get some further information.
</aside>

<p class="codelink">
<a href="Coffee/lod_and_effect.coffee" class="gray">code</a> |
<a href="Data/insulinlod.json" class="gray">data</a></p>

<script type="text/javascript" src="JS/lod_and_effect.js"></script>
<p class="pg">17</p></section>




<section>

<h3>&nbsp;</h3>

<div id="lod_alltimes_fig" style="font-size:20px;margin-left:-50px;"></div>

<aside>
I write a lot of reports to collaborators, describing my analysis
results and conclusions.
It&rsquo;s hard to anticipate all possible questions that a collaborator
might have. (&ldquo;What gene is that?&rdquo;) And you can only show
so many pictures. <br><br>

Including interactive graphs in a report allows my collaborators to
answer a lot of their own questions on their own and to more fully
explore their own data.
And a single interactive graph can take the place of thousands of
static ones.<br><br>

Here we consider a phenotype measured over time, and perform QTL
analysis with each time point individually, to seek genetic loci that
affect the response.<br><br>

The top-left plot is a &ldquo;heat map&rdquo; of the LOD scores
for each time point at each genomic position.  LOD scores are also
colored to indicate the sign of the QTL effect, with red indicating
that BB lines have larger phenotype values and blue indicating that AA lines
have larger phenotype values.  We consider only those (position, time)
pairs with LOD > 1.<br><br>

When you hover over a point in the top-left plot, the LOD curves for the
corresponding time are shown below, and the phenotype averages and
estimated QTL effect (across time) for the corresponding genomic
position are shown to the right.<br><br>

Click on a point to show pointwise confidence bands on the QTL
effect (&plusmn; 2 SE).  (We require a mouse click, as otherwise the graph
was painfully slow to refresh.)
</aside>


<p class="codelink">
<a href="Coffee/lod_alltimes.coffee" class="gray">code</a> |
<a href="Data/all_lod.json" class="gray">data</a></p>

<script type="text/javascript" src="JS/lod_alltimes.js"></script>

<p class="pg">18</p></section>



<section>

<h3>&nbsp;</h3>

<div id="lod_onetime_random_fig" style="margin-left:-30px;"></div>

<p class="codelink">
<a href="Coffee/lod_onetime_random.coffee" class="gray">code</a> |
<a href="Data/onetime_random.json" class="gray">data</a></p>


<script type="text/javascript" src="JS/lod_onetime_random.js"></script>

<aside>
Interactive graphs are incredibly valuable educational tools.<br><br>

You can only show so many static graphs, and it can be a big step to get
students to make more, on their own.<br><br>

Interactive graphs can be a big help to build students&rsquo; intution
and understanding, both as a demonstration, and as a tool that they
can play with.<br><br>

This is an illustration of permutation test: Click the green button to shuffle
the phenotypes and re-draw the LOD curves.
</aside>

<p class="pg">19</p></section>





<section nopadding>
<h3><a href="http://d3js.org">D3</a> is awesome!</h3>

<div id="learnd3" class="medtop">
<p>You <span class="darkgray">just</span> need to learn html, css, svg, and javascript.</p>
<p id="dotenter" style="opacity:0;">And don&rsquo;t forget <code>.enter()</code></p>
</div>

<div id="collision" style="position:fixed;top:-10px;left:-50px;width:1280px;height:960px;">
</div>

<div style="position:fixed;bottom:10px;left:10px;">
<code style="font-size:28px;"><a href="http://mbostock.github.io/d3/talk/20111018/collision.html">http://mbostock.github.io/d3/talk/20111018/collision.html</a></code></div>

<aside>
I&rsquo;m using <a href="http://d3js.org">D3</a>, a javascript
library for data visualization.  (D3 stands for &ldquo;data-driven
documents.&rdquo;)<br><br>

This is one of the images that convinced me that I wanted to learn D3.
There are lots of additional examples at the <a
href="https://github.com/mbostock/d3/wiki/Gallery">D3
gallery</a>.<br><br>

There&rsquo;s a ton to learn, and it&rsquo;s rather forbidding (and much of it is
dull).<br><br>

My most common mistake is to forget to include <code>.enter()</code>.
No error is given, but nothing shows up in the plot.
</aside>
<p class="pg">21</p></section>
<script type="text/javascript" src="JS/collision.js"></script>






<section>
<h3><a href="http://jsfiddle.net">JSFiddle</a> is awesome!</h3>

<a href="http://jsfiddle.net/kbroman/v4qhh/5">
    <img height=700 style="position:fixed;bottom:50px;left:100px;" src="Figs/jsfiddle.png">
</a>

<aside>
D3 can be forbidding, but just start making stuff. It&rsquo;s fun, and
eventually it&rsquo;s productive.<br><br>

Learn to use your browser&rsquo;s developer tools. When something goes
wrong, typically you just get a blank screen. The developer tools show
the error messages, and you can test things on-the-fly.<br><br>

<a href="http://jsfiddle.net">jsfiddle</a> is a huge help for learning
javascript and D3. There are separate boxes for html, css, javascript,
and the result.
</aside>
<p class="pg">22</p></section>





<section>
<h3><a href="http://coffeescript.org">Coffeescript</a> is awesome!</h3>

<div id="coffee" class="medtop">
<p><code>blob.attr("x", <span class="highlight">(d) -> d.x</span>)</code><br><br>
<code>height = options<span class="highlight">?.</span>height ? 500</code>
</p>
</div>

<aside>
(I think maybe I&rsquo;ve seen the <a
href="http://www.lego.com/en-us/movie">Lego Movie</a> too many
times.)<br><br>

I&rsquo;m using <a href="http://coffescript.org">CoffeeScript</a>
rather than javascript. It gets translated to javascript, and
it&rsquo;s a much nicer language.<br><br>

Particularly nice are the light-weight anonymous
functions. You&rsquo;ll be writing <em>a lot</em> of anonymous
functions in D3.<br><br>

Also, there&rsquo;s a simple syntax for handling <code>null</code>
values, for things like options.
</aside>
<p class="pg">23</p></section>


<section>
<h3><a href="http://coffeescript.org">Coffeescript</a> is awesome!</h3>

<div id="coffee" class="medtop">
<p><code>blob.attr("x", <span class="highlight">(d) -> d.x</span>)</code><br><br>
<code>height = options<span class="highlight">?.</span>height ? 500</code>
</p>
</div>

<a href="http://jsfiddle.net/kbroman/cfscr/94">
    <img height=600 style="position:fixed;bottom:10px;left:200px;" src="Figs/jsfiddle_coffee.png">
</a>

<aside>
And you can use <a href="http://jsfiddle.net">jsfiddle</a> with
CoffeeScript.
</aside>
<p class="pg">23</p></section>















<section>
<h3>Summary</h3>

<ul class="tight">
  <li><span class="highlight">Interactive</span> graphics
  require effort, but they</li>

      <ul class="lowlight">
        <li>Facilitate exploration</li>
        <li>Are great collaborative tools</li>
        <li>Enable summaries with access to the details</li>
        <li>Are great for teaching</li>
      </ul>

  <li>Visualizations must be <span
  class="highlight">tailored</span> to the data and
  questions</li>

  <li><a href="http://d3js.org" class="highlight">D3</a> is rather low level, but it</li>
      <ul class="lowlight">
        <li>Is totally flexible</li>
        <li>Provides hours of enjoyment</li>
        <li>Can provide other hours of frustration</li>
      </ul>

  <li><a href="http://rstudio.com">RStudio</a>&rsquo;s <a
  href="http://shiny.rstudio.com">Shiny</a> and <a
  href="http://ggvis.rstudio.com">ggvis</a> are also really exciting.</li>

  <li>Write modular, reusable tools rather than scripts</li>

</ul>

<aside>
It&rsquo;s always good to have a summary slide with your key points.
</aside>
<p class="pg">28</p></section>






<script type="text/javascript" src="JS/stack.v0.js"></script>
<script type="text/javascript" src="JS/handle_stickies.js"></script>
</body>
</html>
